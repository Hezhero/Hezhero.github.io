---
title: 第四章 信息安全技术基础知识
author: hzhero
date: 2023-06-05 19:30:00 +0800
categories: [系统架构师, 第四章]
tags: [第四章]     # TAG names should always be lowercase
math: true
mermaid: true
render_with_liquid: false
---
# 第四章 信息安全技术基础知识

## 信息安全基础知识

### 概念

- 5个基本要素

	- 机密性
	- 完整性
	- 可用性
	- 可控性
	- 可审查性

- 4个范围

	- 设备安全

		- 3个方面

			- 设备的稳定性
			- 设备的可靠性
			- 设备的可用性

	- 数据安全

		- 3个方面

			- 数据的秘密性
			- 数据的完整性
			- 数据的可用性

	- 内容安全

		- 3个方面

			- 信息内容在政治上是健康的
			- 信息内容符合国家的法律法规
			- 信息内容符合中华民族优良的道德规范

	- 行为安全

		- 3个特性

			- 行为的秘密性
			- 行为的完整性
			- 行为的可控性

### 信息存储安全

- 包括5个方面

	- 信息使用的安全

		- 用户的标识与验证

			- 2种方法

				- 基于人的物理特征的识别

					- 签名识别法
					- 指纹识别法
					- 语音识别法

				- 基于用户所拥有特殊安全物品的识别

					- 智能IC卡识别法
					- 磁条卡识别法

		- 用户存取权限限制

			- 2种方法

				- 隔离控制法

					- 物理隔离方式
					- 时间隔离方式
					- 逻辑隔离方式
					- 密码技术隔离方式

				- 限制权限法

					- 用户分类管理
					- 目录、文件访问控制
					- 临时文件加密，尽快移走或删除

	- 系统安全监控

		- 4个方面工作

			- 监控当前正在进行的进程和正在登录的用户情况
			- 检查文件的所有者、授权、修改日期情况和文件的特定访问控制属性
			- 检查系统命令安全配置文件、口令文件、核心启动运行文件、任何可执行文件的修改情况
			- 检查用户登录的历史记录和超级用户登录的记录，如发现异常应及时处理

	- 计算机病毒防治

		- 计算机病毒5个特点

			- 隐蔽性
			- 传染性
			- 潜伏性
			- 触发性
			- 破坏性

		- 10种防治手段

			- 经常从软件供应商网站下载、安装安全补丁程序和升级杀软
			- 定期检查敏感文件
			- 使用高强度口令
			- 经常备份重要数据，每天备份
			- 选择、安装经过公安部认证的防病毒软件，定期检测
			- 在计算机和因特网之间安装使用防火墙，提高系统的安全性
			- 当计算机不使用时，不要接入因特网，一定要断掉网络连接
			- 重要的计算机系统和网络一定要严格与因特网物理隔离
			- 不要打开陌生人发来的电子邮件
			- 正确配置系统和使用病毒防治产品

	- 数据的加密
	- 防止非法的攻击

### 网络安全

- 网络安全漏洞

	- 物理安全性
	- 软件安全漏洞
	- 不兼容使用安全漏洞
	- 选择合适的安全哲理

		- 这是一种对安全概念的理解和直觉，用户使用完美的软件也要选择适当的安全策略、打开安全部件

- 网络安全威胁

	- 5个方面

		- 非授权访问
		- 信息泄露或丢失
		- 破坏数据完整性
		- 拒绝服务攻击
		- 利用网络传播病毒

- 安全措施的目标

	- 5个方面

		- 访问控制
		- 认证
		- 完整性

			- 确保接收到的信息和发送的一致

		- 审计
		- 保密

## 信息系统安全的作用和意义

## 信息安全系统的组成框架

### 技术体系

- 5个方面

	- 基础安全设备
	- 计算机网络安全
	- 操作系统安全
	- 数据库安全
	- 终端设备安全

### 组织机构体系

- 3个模块

	- 机构

		- 3个层次

			- 决策层
			- 管理层
			- 执行层

	- 岗位

		- 负责一个或几个安全事务的职位

	- 人事机构

		- 对岗位上的雇员进行素质教育、业绩考核和安全监管的机构

### 管理体系

- 3个部分

	- 法律管理
	- 制度管理
	- 培训管理

## 信息加解密技术

### 数据加密

- 防止未经授权的用户访问敏感信息的手段

### 对称密钥加密算法

- 定义

	- 加密密钥和解密密钥是相同的，称为共享密钥算法或对称密钥算法

- 分类

	- DES(Data Encryption Standard)

		- 原理

			- 两部分

				- Feistel结构
				- 16 个字密钥的生成

			- 明文分成64位的块
			- 对每个块进行19次变换（替代和换位）

				- 其中16次变换由56位的密钥的不同排列形式控制

			- 最后产生64位的密文块

		- 优缺点

			- 优点

				- 简单、容易实现、运行效率高

			- 缺点

				- 分组比较短、密码生命周期短、容易被暴力破解、密钥难管理、不好分配、无签名认证功能

	- 3DES

		- 原理

			- 用两个密钥进行三重DES加密操作

				- 用密钥K1进行DES加密
				- 用K2对第一步的结果进行DES解密
				- 对第二步的结果使用K1进行DES加密

		- 优缺点

			- 优点

				- 算法公开、112位密钥长度更强壮

			- 缺点

				- 花费3倍DES加密时间、交易双方都使用相同的密钥，安全性无法保证、密钥管理困难

	- IDEA(International Data Encryption Algorithm)

		- 原理

			- 明文分成64位的块
			- 进行8轮迭代加密
			- 最后生成128位的密钥

		- 优缺点

			- 优点

				- 比RSA算法加解密快

			- 缺点

				- 需要获取商业授权才能用、解密过程密钥需要求逆且有些微小差别

	- AES(Advanced Encryption Standard)

		- 原理

			- 密钥扩展

				- 对密钥扩展，生成一系列的轮密钥

			- 初始轮

				- 明文和轮密钥进行一次异或操作

			- 轮交换

				- 9轮SubBytes操作

			- 最终轮

				- 使用SubBytes、ShiftRows和轮密钥进行异或操作

			- 解密

				- 使用与加密相同的轮密钥，按照相反的顺序操作

		- 常用5种模式

			- ECB模式（电子密码本模式）

				- 将整个明文分成若干段相同的小段，然后对每一小段进行加密

			- CBC模式（密码分组链接模式）

				- 将明文分成若干小段，然后每一小段与初始块或者上一段的密文段进行异或运算后，再与密钥进行加密

			- CFB模式（密码反馈模式）
			- OFB模式（输出反馈模式）
			- CTR模式（计算器模式）

				- 有一个字增的算子，用密钥加密之后的输出和明文异或得到密文，一次一密，且密钥只能用一次

		- 优缺点

			- 优点

				- 可以生成128、192、256位3种密钥长度
				- OFB/CFB只需要加密不需要解密
				- CTR适用于并行计算获得较好的速度

			- 缺点

				- ECB不能用同一个key加密多个block，容易被攻击
				- CBC/OFB/CFB不利于并行计算

### 非对称密钥加密算法

- RSA（Rivest Shamir and Adleman)

	- 使用的加密密钥和解密密钥不同，称为不共享密钥算法或非对称密钥算法
	- 加密和解密是互逆的

		- 用公钥加密，私钥解密，实现加密通信
		- 用私钥加密，公钥解密，实现数字签名

## 密钥管理技术

### 对称密钥的分配与管理

- 2个目标

	- 引进自动分配密钥机制，提高系统效率
	- 尽可能减少系统中驻留的密钥量

- 密钥的使用控制

	- 密钥标签

		- 密钥中8个校验位作为标签

	- 控制矢量

		- KDC（密钥分配中心）共享的主密钥与KDC给的控制矢量一起用才能获得会话密钥

- 密钥的分配

	- 4种方式

		- A通过物理手段发送给B
		- 第三方通过物理手段发送给A、B
		-  A、B用原有密钥加密新的密钥后，发送给对方
		- 三方A、B、C各有一保密信道，C选取密钥后，分别通过A、B各自的保密信道发送

### 公钥加密体制的密钥管理

- 公开发布
- 公用目录表
- 公钥管理机构
- 公钥证书

### 公钥加密分配单钥密码体制的密钥

## 访问控制及数字签名技术

### 访问控制技术

- 基本模型

	- 3要素

		- 主体（Subject）

			- 可以对其他实体施加动作的主动实体，简记为S

		- 客体（Object）

			- 接受其他实体访问的被动实体，简记为O

		- 控制策略

			- 主体对客体的操作行为集和约束条件集，简记为KS

	- 3方面内容

		- 认证
		- 控制策略的具体实现
		- 审计

- 实现技术

	- 访问控制矩阵（ACM Access Control Matrix）

		- 通过矩阵形式表示访问控制规则和授权用户权限的方法

	- 访问控制表（ACL Access Control Lists） 

		- 按列保存访问矩阵

	- 能力表（Capabilities）

		- 按行保存访问矩阵

	- 授权关系表（Authorization Relations）

		- 通过访问矩阵中每一个非空元素获取权限信息，按主体排序查询时得到能力表的效率，按客体排序，查询时得到访问控制表的效率

			- 通常用于安全数据库系统

### 数字签名

- 作用

	- B可以验证消息P确实来源于A
	-  A以后不能否认发送过P
	-  B不能编造或改变消息P

- 数字签名的5个条件

	- 签名是可信的
	- 签名不可伪造
	- 签名不可重用
	- 签名的文件是不可改变的
	- 签名是不可抵赖的

- 对称密钥签名

	- 有个共同信赖的中间人负责签名消息

- 公开密钥签名

	- A用私钥加密，再用B的公钥加密，发给B
	-  B先用私钥解密，在用A的公钥解密

## 信息安全的抗攻击技术

### 密钥的选择

- 密钥分两大类

	- 数据加密密钥（DK）

		- 直接对数据进行操作

	- 密钥加密密钥（KK）

		- 用于保护密钥，使之通过加密而安全传递

- 密钥生成考虑3个方面

	- 增大密钥空间
	- 选择强钥
	- 密钥的随机性

### 拒绝服务攻击与防御

- 拒绝服务攻击DoS（Denial of Service）

	- 定义

		- 由人为或非人为发起的行动，使主机硬件、软件或者两者同时失去工作能力，使系统不可访问并因此决绝合法的用户服务要求

			- 常见的攻击位分布式拒绝服务攻击DDos（Distributed Denial of Service）

	- 两种攻击思路

		- 服务器的缓冲区满，不接受新的请求
		- 使用IP欺骗，迫使服务器把合法用户的连接复位，影响合法用户的连接

	- 分类

		- 消耗资源

			- 针对网络连接的拒绝服务攻击
			- 消耗磁盘空间
			- 消耗CPU资源和内存资源

		- 破坏或更改配置信息
		- 物理破坏或改变网络部件
		- 利用服务程序中的处理错误使服务失效

	- DDos攻击

		- 被攻击的现象

			- 被攻击主机上有大量等待的TCP连接
			- 大量到达的数据分组并不是网站服务连接的一部分，往往指向机器的任意端口
			- 网络中充斥着大量无用的数据包，源地址为假
			- 制造高流量的无用数据造成网络拥塞，使受害主机无法正常和外界通信
			- 利用受害主机提供的服务和传输协议上的缺陷，反复发出服务请求，使受害主机无法及时处理所有正常请求
			- 严重时会造成死机

		- DDos工具三级结构

			- Client

				- 客户端，运行在攻击者的主机上，用来发起和控制DDos攻击

			- Handler

				- 主控端，运行在已被攻击者侵入并获得控制的主机上，用来控制代理端

			- Agent

				- 代理端，运行在已被攻击者侵入并获得控制的主机上，从主控端接受命令，服务队目标实施实际的攻击

- 防御

	- 4种方法

		- 加强对数据包的特征识别
		- 设置防火墙监视本地主机端口的使用情况
		- 对通信数据量进行统计也可获得有关攻击系统的位置和数量信息
		- 尽可能的修正已经发现的问题和系统漏洞

### 欺骗攻击与防御

- ARP欺骗

	- 攻击方式

		- A和B信任通信
		- C把B搞瘫痪
		- C发送ARP响应报文给A，告诉A：B这个IP对应的MAC地址是C的MAC地址

	- 防范措施

		- 固化ARP表，防止ARP欺骗
		- 使用ARP服务器，确保ARP服务器不被黑
		- 采用双向绑定的方法解决并且防止ARP欺骗
		- ARP防护软件- ARP Guard

-  DNS欺骗

	- 攻击方式

		- 冒充域名服务器，把查询的IP地址设置攻击者的IP地址

	- 防范措施

		- 被动监听检测

			- 旁路监听，一定时间内一个请求对应两个或两个以上结果不同的应答包，则被攻击了

		- 虚假报文探测

			- 向一个确定是非DNS服务器发送请求包，如果收到了应答包，则说明被攻击了

		- 交叉检查查询

			- 收到DNS应答包之后，再反向查询IP对应的DNS域名，如果前后不一致，则说明被攻击了

- IP欺骗

	- 攻击方式

		- 截获并改变发出的包的IP地址

			- 比较难，因为TCP协议相对可靠，三次握手建立信赖连接，如果要实现的话就要先使对方主机失去工作能力，比如DDos使之瘫痪

	- 防范措施

		- 删除UNIX中所有的/etc/hosts.equiv、$HOME/.rhosts
		- 修改/etc/inetd.conf,使RPC机制无法应用
		- 设置防火墙过滤来自外部而信源地址却是内部IP的报文

### 端口扫描

- 目的

	- 判断目标主机上开房了哪些服务
	- 判断目标主机的操作系统

- 分类

	- 全TCP连接

		- 使用三次握手建立连接确认

			- 容易被目标主机记录

	- 半打开式扫描（SYN扫描）

		- 先向目标端口发送SYN数据段，表示连接请求
		- 如果回应TCP报文中SYN=1，ACK=1，说明端口是活动，然后发送一个RST数据段拒绝连接
		- 如果回应的是RST，则说明是死端口

	- FIN扫描

		- 发送TCP报文带FIN字段
		- 如果回应RST，则说明是活动端口
		- 如果没回应，则说明是死端口

	- 第三方扫描

		- 通过肉鸡代理扫描

### 强化TCP/IP堆栈以抵御拒绝服务攻击

- 同步包风暴（SYN Flooding）

	- 客户端一次握手后不响应，导致服务器发起二次握手的SYN+ACK包会重试5次，这种大量恶意请求会导致服务器创建大量半连接，资源不足

	  重试5次会用指数退避算法，即下次重试是当前的两倍，如1s，2s，4s，8s，16s
	  
		- LINUX和WINDOWS都有TCP参数可以调整去应对
		- 消耗服务器资源主要是因为当 SYN 数据报文一到达，系统立即分配 TCB，从而占用了资源

			- 延缓创建TCB

				- Syn Cache 技术

					- 一个专用 Hash 表中保存这种半连接信息

				- Syn Cookie 技术

					- 使用一种特殊的算法生成 Sequence Number，

					  这种算法考虑到了对方的 IP、端口、己方 IP、端口的固定信息，以及对方无法知道而己方比较固定的一些信息。
					  
					  如 MSS(Maximum Segment Size，最大报文段大小，指的是 TCP 报文的最大数据报长度，其中不包括 TCP 首部长度。)、时间等。
					  
					  在收到对方的 ACK 报文后，重新计算一遍，看其是否与对方回应报文中的（Sequence Number-1）相同，从而决定是否分配 TCB 资源
					  
			- 使用 SYN Proxy 防火墙

				- 防火墙确认连接的有效性后，防火墙才会向内部服务器发起 SYN 请求

- ICMP攻击

	- ICMP是TCP/IP子协议，用于在主机和路由器之间传递控制信息，ICMP就是一个“错误侦测与回报机制”，发送的出错报文会返回到发送原数据的设备

		- 攻击手段

			- “Ping of Death” 攻击的原理是：如果ICMP数据包的尺寸超过64KB上限时，主机就会出现内存分配错误，导致TCP/IP堆栈崩溃，致使主机死机。

				- 操作系统已经取消了发送ICMP数据包的大小的限制，解决了这个漏洞

			- 向目标主机长时间、连续、大量地发送ICMP数据包，也会最终使系统瘫痪。大量的ICMP数据包会形成“ICMP风暴”，使得目标主机耗费大量的CPU资源处理，疲于奔命

		- 防御手段

			- 在路由器上对ICMP数据包进行带宽限制，将ICMP占用的带宽控制在一定的范围内
			- 在操作系统上设置包过滤
			- 在主机上安装防火墙

				- 防火墙应该具有状态检测、细致的数据包完整性检查和很好的过滤规则控制功能

- SNMP攻击

	- 通过一台客户端机器向一个被管理的设备发出查询请求获取这台设备当前运行状态的检测等情况

		- 攻击手段

			- 请求流量小，查询结果返回流量大
			- 结合伪造源地址实现攻击

		- 防御手段

			- 关闭SNMP服务

### 系统漏洞扫描

- 基于网络的漏扫

	- 网络漏扫器5个组成部分

		- 漏洞数据库模块
		- 用户配置控制台模块
		- 扫描引擎模块
		- 当前活动的扫描知识库模块
		- 结果存储器和报告生成工具

	- 优点

		- 价格便宜
		- 操作过程中不需要涉及目标系统的管理员
		- 检测过程中不需要在目标系统上安装任何东西
		- 维护简便

- 基于主机的漏扫

	- 在目标系统上安装一个代理Agent或服务Service
	- 优点

		- 扫描的漏洞数量多
		- 集中化管理
		- 网络流量负载小

## 信息安全的保障体系与评估方法

### 计算机信息系统安全保护等级

- 5个等级

	- 第一级 用户自主保护级

		- 对应TCSEC的C1级

	- 第二级 系统审计保护级

		- 对应TCSEC的C2级

	- 第三级 安全标记保护级

		- 对应TCSEC的B1级

	- 第四级 结构化保护级

		- 对应TCSEC的B2级

	- 第五级 访问验证保护级

		- 对应TCSEC的B3级

### 安全风险管理

- 风险评估5个方面

	- 确定风险评估范围
	- 确定风评目标
	- 建立适当的组织机构
	- 建立系统性的风险评估方法
	- 获得最高管理者对风评策划的批准

- 风评的基本要素

	- 脆弱性

		- 相关属性

			- 业务战略

	- 资产

		- 相关属性

			- 资产价值

	- 威胁

		- 相关属性

			- 安全需求

	- 风险

		- 相关属性

			- 安全事件

	- 安全措施

		- 相关属性

			- 残余风险

- 风险计算过程

	- 对信息资产进行识别，并对资产赋值
	- 对威胁进行分析，并对威胁发生的可能性赋值
	- 识别信息资产的脆弱性，并对弱点的严重程度赋值
	- 根据威胁和脆弱性计算安全事件发生的可能性
	- 结合信息资产的重要性和发生安全事件的可能性，计算信息资产的风险值

